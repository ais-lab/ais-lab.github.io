{%- assign alumni = site.data.members | where: "status", "alumnus" -%}
{%- assign alumni_by_year = alumni | group_by_exp: "item", "item.alumnus_date | date: '%Y'" | sort: "name" | reverse -%}

{%- for year_group in alumni_by_year -%}

  <h2>{{ year_group.name }}</h2>
  {%- assign year_members = year_group.items -%}

  <div class="alumni-role-group">
    {%- assign phds = year_members | where: "role", "phd" | sort: "name" -%}
    {%- if phds.size > 0 -%}
      <p>
        <strong>D: </strong>
        {%- for member in phds -%}
          {{ member.name }}{%- unless forloop.last -%},  {%- endunless -%}
        {%- endfor -%}
      </p>
    {%- endif -%}

    {%- assign masters = year_members | where: "role", "m" | sort: "name" -%}
    {%- if masters.size > 0 -%}
      <p>
        <strong>M: </strong>
        {%- for member in masters -%}
          {{ member.name }}{%- unless forloop.last -%},  {%- endunless -%}
        {%- endfor -%}
      </p>
    {%- endif -%}

    {%- assign bachelors = year_members | where: "role", "b" | sort: "name" -%}
    {%- if bachelors.size > 0 -%}
      <p>
        <strong>B: </strong>
        {%- for member in bachelors -%}
          {{ member.name }}{%- unless forloop.last -%},  {%- endunless -%}
        {%- endfor -%}
      </p>
    {%- endif -%}
  </div>

{%- endfor -%}